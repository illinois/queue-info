import withPost from '../../components/blog/WithPost'
import Image from '../../components/Image'

export const meta = {
  title:
    'New Release: Confidential Queues, Programmatic Admission Control & More',
  date: '2019-03-13',
  featured: true,
  authors: [
    {
      name: 'Nathan Walters',
      github: 'nwalters512',
      avatar: '/static/team/nathan.jpg',
    },
    {
      name: 'Jacqueline Osborn',
      github: 'jackieo5023',
      avatar: '/static/team/jackie.jpeg',
    },
  ],
}

export default withPost({ ...meta })

## Confidential queues

In an ordinary queue, information such as a student's name, location, and topic are available for anyone to view. However, we've noticed a great amount of use cases where you would want to keep this information private. Thus, a new type of queue was created &mdash; a _confidential queue_! With a confidential queue, other students only know the number of people on the queue and the number of people in front of them.

For members on course staff of a confidential queue, the queue will still look the same as always, save for a little icon denoting the confidentiality of the queue by the title. Students on the queue will see something like the picture below.

<Image
  src="/static/blog/confidential-queues-programmatic-admission-control/confidential-queue-student-view.jpg"
  caption="The confidential queue view from a student perspective"
  shadow
/>

When creating a confidential queue, all you have to do is toggle the setting on creation! Keep in mind that you will not be able to change this once the queue is created.

## Programmatic admission control

By default, anyone at Illinois can add themselves to any other queue without any restrictions. This is generally a good thing &mdash; it allows for flexibility and allows instructors to not have to worry about keeping rosters up to date. So far we haven't seen people abusing the system by adding themselves to random queues, which is great!

However, maybe you do want to restrict your queue to only people on your official roster. Or maybe you have other reasons you want to keep certain questions off your queue. For instance, in CS 225, a lot of people put overly-short topics, like "lab" or "mp6". We prefer that students write more descriptive topics to show that they've put some thought into the question they're asking. But right now, we have to enfore that policy manually.

Enter _programmatic admission control_. This feature allows you to specify an HTTP endpoint that will be used to validate each question that is submitted to your queue. Based on the topic, location, or user information, you can decide to either allow a question or reject it and show a reason to the student.

Here's a simple example written in Node with [Express](https://expressjs.com/).

```js
const express = require('express')
const bodyParser = require('body-parser')
app.use(bodyParser.json())

app.post('/', (req, res) => {
  if (req.body.topic && req.body.topic.length >= 10) {
    res.status(200).json({ allowed: true })
  } else {
    res.status(200).json({
      allowed: false,
      reason: 'Topic must be at least 10 characters'
    })
  }
})

app.listen(port, () => console.log(`listening on port ${port}`)
```

This is a pretty simple example of an admission control policy: it only required that question have a topic with 10 or more characters. But because the interface to your policy is plain old HTTP, you can write your policy in any language, with any tool, using any data you want. For example, in CS 225, we're working on a machine learning model that can automatically classify certain questions as bad to encourage students to write more descriptive questions without any intervention from staff!

Ton configure an admission control policy for your queue, check out the new queue settings page, accessing from the "Settings" button on your queue cards. Look out for more new features to be available on this page in the coming months!

<Image
  src="/static/blog/confidential-queues-programmatic-admission-control/admission-control-settings.png"
  caption="The admission control panel on the new queue settings page"
  shadow
/>
